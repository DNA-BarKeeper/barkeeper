<% provide(:title, @home.title) %>
<%= show_val_errors(@home)%>

<div class="panel panel-default">

  <div class="panel-heading">
    <h3 class="panel-title"><%= @home.title %></h3>
  </div>

  <div class="panel-body">
    <%= form_for(@home) do |f| %>
      <table  class="table table-striped table-hover table-bordered">
        <tr>
          <th><%= f.label :title %></th>
          <td><%= f.text_field :title,  class: 'form-control' %></td>
        </tr>
        <tr>
          <th><%= f.label :subtitle %></th>
          <td><%= f.text_field :subtitle,  class: 'form-control' %></td>
        </tr>
        <tr>
          <th><%= f.label :description %></th>
          <td><%= f.text_area :description,  class: 'form-control' %></td>
        </tr>
        <tr>
          <th><%= f.label :background_image, 'About Page Background' %></th>
          <td>
            <% if @home.background_image.attached? %>
              <%= image_tag @home.background_image.variant(resize: "100x100").processed.service_url %>
              <%= f.check_box(:delete_background_image) %>
              <%= "Remove current image ('#{@home.background_image.filename}')" %>
            <% end %>
            <%= f.file_field :background_image,  class: 'form-control' %>
          </td>
        </tr>
      </table>

<!--      <div class="form-group">-->
        <%#= f.label :title %>
        <%#= f.text_field :title,  class: 'form-control' %>
<!--      </div>-->

<!--      <div class="form-group">-->
        <%#= f.label :subtitle %>
        <%#= f.text_field :subtitle,  class: 'form-control' %>
<!--      </div>-->

<!--      <div class="form-group">-->
        <%#= f.label :description %>
        <%#= f.text_area :description,  class: 'form-control' %>
<!--      </div>-->

<!--      <div class="form-group">-->
<!--        <%#= f.label :background_image, 'About Page Background' %><br>-->
        <%# if @home.background_image.attached? %>
<!--          <%#= image_tag @home.background_image.variant(resize: "100x100").processed.service_url %><br>-->
          <%#= f.check_box(:delete_background_image) %>
          <%#= "Remove current image ('#{@home.background_image.filename}')" %>
        <%# end %>
        <%#= f.file_field :background_image,  class: 'form-control' %>
<!--      </div>-->

      <%#= f.nested_fields_for :logos, @home.logos.where(partner: false).with_attached_image do |main_logo_form| %>
<!--        <div class="form-group">-->

<!--          <div class="form-group">-->
            <%#= main_logo_form.label :url, 'Project URL' %>
            <%#= main_logo_form.text_field :url,  class: 'form-control' %>
<!--          </div>-->

          <%#= main_logo_form.check_box :partner, active: true, hidden: true %>

<!--          <div class="form-group">-->
            <%#= main_logo_form.label :title, 'Project Logo Title' %>
            <%#= main_logo_form.text_field :title,  class: 'form-control' %>
<!--          </div>-->

<!--          <%#= main_logo_form.label :image, 'Project Logo' %><br>-->
          <%# if main_logo_form.object&.image&.attached? %>
<!--            <%#= image_tag main_logo_form.object.image.variant(resize: "100x100").processed.service_url %><br>-->
            <%#= main_logo_form.check_box(:delete_image) %>
            <%#= "Remove current image ('#{main_logo_form.object.image.filename}')" %>
          <%# end %>
          <%#= main_logo_form.file_field :image,  class: 'form-control' %>
<!--        </div>-->
      <%# end %>

      <table style="overflow: scroll;" class="table table-striped table-hover table-bordered">
        <thead>
        <tr>
          <th>Title</th>
          <th>URL</th>
          <th>Current logo</th>
          <th>Upload new logo</th>
          <th></th>
        </tr>
        </thead>

        <tbody>
          <%= f.nested_fields_for :logos, @home.logos.where(partner: true).with_attached_image.order(title: :desc) do |logos_form| %>
            <tr>
              <td><%= logos_form.text_field :title, class: 'form-control' %></td>
              <td><%= logos_form.text_field :url, class: 'form-control' %></td>
              <td style="text-align: center;">
                <% if logos_form.object.image.attached? %>
                  <%= image_tag logos_form.object.image.variant(resize: "100x100").processed.service_url %><br>
                  <%= logos_form.check_box(:delete_image) %>
                  <%= "Remove current image ('#{logos_form.object.image.filename}')" %>
                <% end %>
              </td>
              <td><%= logos_form.file_field :image, class: 'form-control' %></td>
              <td><%= logos_form.remove_nested_fields_link 'Remove', data: { confirm: "Are you sure?\n(You need to update to permanently remove the logo.)" } %></td>
            </tr>
          <% end %>
        <footer>
          <td colspan=5>
            <%= f.add_nested_fields_link :logos do %>
              <span>Add new Partner Logo</span>
            <% end %>
            (You need to update to permanently add or remove an image.)</td>
        </footer>
        </tbody>
      </table>
      <br><br>

      <%= f.submit 'Update', :class => 'btn btn-default' %>

    <% end %>
  </div>
</div>
