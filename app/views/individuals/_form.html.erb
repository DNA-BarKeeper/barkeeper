<% provide(:title, @individual.specimen_id) %>
<%= show_val_errors(@individual)%>

<div class="panel panel-default">

  <div class="panel-heading">
    <h3 class="panel-title">Specimen <%= @individual.specimen_id %>
      <% if @individual.try(:species) %>
          - <%=link_to(@individual.species.name_for_display, edit_species_path(@individual.species.id))  %>
      <% end %>
    </h3>
  </div>

  <div class="panel-body">
    <%= form_for(@individual) do |f| %>

        <ul class="nav nav-tabs" role="tablist">
          <li class="active"><a href="#description" role="tab" data-toggle="tab">Description</a></li>
          <li><a href="#locality" role="tab" data-toggle="tab">Locality</a></li>
          <li ><a href="#assigned_isolates" role="tab" data-toggle="tab">Isolates</a></li>
          <li>
            <a href="#sativa_warnings" role="tab" data-toggle="tab" style="<%= warning_color_individual(@individual) %>">
              <span class="glyphicon glyphicon-exclamation-sign"></span> Potential issues
            </a>
          </li>
        </ul>

        <div class="tab-content">
          <div class="tab-pane active" id="description">
            <br>

            <div class="form-group">
              <%= f.label :specimen_id, 'Specimen ID' %>
              <%= f.text_field :specimen_id, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :DNA_bank_id, 'Associated DNA Bank ID' %>
              <%= f.text_field :DNA_bank_id, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label 'Species' %>
              <% if @individual.species %>
                  <%= link_to '', edit_species_path(@individual.species), :class => 'glyphicon glyphicon-share-alt', :title => "go to #{@individual.species.composed_name} " %>
              <% end %>
              <%= f.text_field :species_name, data: { autocomplete_source: filter_species_index_path }, class: 'form-control'%>
            </div>

            <div class="form-group">
              <%= f.label 'Herbarium' %>
              <% if @individual.herbarium %>
                <%= link_to '', edit_herbarium_path(@individual.herbarium), :class => "glyphicon glyphicon-share-alt" %>
              <% end %>
              <%= f.collection_select(:herbarium_id, Herbarium.all, :id, :name, { include_blank: '<no selection>' }, { class: 'form-control' }) %>
            </div>

            <div class="form-group">
              <%= f.label :tissue_id, 'Tissue type' %>
              <%= f.collection_select(:tissue_id, Tissue.all.order(:name), :id, :name, { :include_blank => '<no selection>' }, { class: 'form-control' }) %>
            </div>

            <div class="form-group">
              <%= f.label :life_form %>
              <%= f.text_field :life_form, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :collector %>
              <%= f.text_field :collector, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :collectors_field_number, "Collector's Field Number" %>
              <%= f.text_field :collectors_field_number, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :collection_date, 'Collection Date' %>
              <%= f.text_field :collection_date, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :determination %>
              <%= f.text_field :determination, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :revision %>
              <%= f.text_field :revision, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :confirmation %>
              <%= f.text_field :confirmation, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :comments %>
              <%= f.text_area :comments, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :projects, 'Projects this object belongs to' %>
              <%= project_list(@individual) %>
            </div>
          </div>

          <div class="tab-pane" id="locality" >
            <br>
            <div class="form-group">
              <%= f.label :country %>
              <%= f.text_field :country, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label 'State/Province' %>
              <%= f.text_field :state_province, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :locality %>
              <%= f.text_area :locality, class: 'form-control' %>
            </div>
            <div class="form-group">
              <%= f.label 'Latitude' %>
              <%= f.text_field :latitude, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label 'Longitude' %>
              <%= f.text_field :longitude, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label 'Latitude (original)' %>
              <%= f.text_field :latitude_original, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label 'Longitude (original)' %>
              <%= f.text_field :longitude_original, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :elevation %>
              <%= f.text_field :elevation, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :exposition %>
              <%= f.text_field :exposition, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :habitat %>
              <%= f.text_area :habitat, class: 'form-control' %>
            </div>

            <div class="form-group">
              <%= f.label :substrate %>
              <%= f.text_field :substrate, class: 'form-control' %>
            </div>

          </div>

          <div class="tab-pane" id="assigned_isolates">
            <br>
            <table class="table table-striped table-hover table-bordered">

              <thead>
              <tr>
                <th>Isolate ID</th>
              </tr>
              </thead>

              <tbody>
              <% @individual.isolates.each do |c| %>
                  <tr>
                    <td>
                      <%= link_to c.display_name, edit_isolate_path(c) %>
                    </td>
                  </tr>
              <% end %>
              </tbody>

            </table>

          </div>

          <div class="tab-pane" id="sativa_warnings">
            <br>
            <%= contig_issues_individual(@individual) %>
          </div>

        </div>

        <%= f.submit 'Update', :class =>  'btn btn-default' %>

    <% end %>

  </div>
</div>







