<div class="panel panel-default">

  <div class="panel-heading">
    <h3 class="panel-title">Projects</h3>
  </div>

  <div class="panel-body">
    <ul class="nav nav-tabs" role="tablist">
      <li class="active"><a href="#index" role="tab" data-toggle="tab">Project Index</a></li>
      <li><a href="#association" role="tab" data-toggle="tab">Associate Taxa</a></li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active" id="index">
        <br>
        <div class="wideTable">
          <table  class="table table-striped table-hover table-bordered">
            <thead>
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Start</th>
                <th>Due</th>
                <th colspan="3"></th>
              </tr>
            </thead>

            <tbody>
              <% @projects.each do |project| %>
                <tr>
                  <td><%= project.name %></td>
                  <td><%= project.description %></td>
                  <td><%= project.start %></td>
                  <td><%= project.due %></td>
                  <td><%= link_to 'Show', project %></td>
                  <td><%= link_to 'Edit', edit_project_path(project) %></td>
                  <td><%= link_to 'Delete', project, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tab-pane" id="association">
        <br>
        <%= form_tag add_to_taxa_projects_path, :method => :get do %>
          <p>Select a taxon in order to associate it and all its descendants to the selected project:</p>
          <div>
            <%= label :project, 'Project' %><br>
            <%= collection_select :project, :id, user_projects, :id, :name, {}, { multiple: true } %>
          </div>
          <br>
          <div>
            <%= label :query, 'Taxon' %><br>
            <%= text_field_tag :associated_taxon, params[:associated_taxon], data: { autocomplete_source: filter_taxa_path } , class: 'form-control', style: 'display: inline;'%>
          </div>
          <br>
          <%= button_to 'Associate taxa', { type: 'Submit', method: 'get' }, { class: 'btn btn-default' } %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% if user_signed_in? && (current_user.admin? || current_user.supervisor?) %>
  <%= link_to 'New Project', new_project_path %><br>
  <br>
<% end %>
